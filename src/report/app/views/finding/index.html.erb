<h1>Findings</h1>

<ul class="nav nav-tabs" role="tablist">
  <li><a href="/transaction">Transactions</a></li>
  <li class="active"><a href="/finding">Findings</a></li>
</ul>

<h2>Defects</h2>
<table border="1" class="table table-striped table-bordered">
  <thead>
    <tr>
      <th>URI</th>
      <th class="dropdown">
        <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Type
          <span class="caret"></span>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu2" id="dtype">
          <% if @filtered %>
            <li><a href="/finding"">No filter</a></li>
          <%end%>
          <% getTypes.each do |type| %>
            <li><a href="?d=<%=type.id%>"><%= type.description %></a></li>
          <%end%>
        </ul>
      </th>
      <th>Location</th>
      <th>Evidence</th>
      <th>Go to transaction</th>
    </tr>
  </thead>
  <% if @defects.count > 0 %>
  <tbody>
    <% @defects.each do |defect| %>
      <tr>
        <td><%= format(defect.uri) %></td>
        <td><%= defect.description %></td>
        <td><%= defect.location %></td>
        <td><%= defect.evidence %></td>
        <td><a href="/finding/<%= defect.responseId %>">-></a></td>
      </tr>
    <%end%>
  </tbody>
  <%end%>
</table>
<%= will_paginate @defects, :param_name => 'defect', renderer: BootstrapPagination::Rails %>

<h2>Links</h2>
<table border="1" class="table table-striped table-bordered">
  <thead>
    <tr>
      <th>To</th>
      <th>From</th>
      <th>Processed</th>
    </tr>
  </thead>
  <% if @links.count > 0 %>
  <tbody>
    <%  @links.each do |link| %>
      <tr>
        <td><%= format(link.toUri) %></td>
        <td><%= format(link.uri) %></td>
        <td><%= link.processed %></td>
      </tr>
    <%end%>
  </tbody>
  <%end%>
</table>
<%= will_paginate @links, :param_name => 'link', renderer: BootstrapPagination::Rails %>
